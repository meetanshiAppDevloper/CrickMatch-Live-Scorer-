<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Join Tournament - CrickMatch</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .bg-purple-main { background-color: #4A3A8C; }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-6">

    <!-- рлз. PC/Desktop ркорк╛ркЯрлЗ ркорлЗрк╕рлЗркЬ (рк╢рк░рлВркЖркдркорк╛ркВ ркЫрлБрккрк╛ркпрлЗрк▓рлБркВ) -->
    <div id="pc-error" class="hidden bg-white p-8 rounded-3xl shadow-xl max-w-sm w-full text-center">
        <div class="text-5xl mb-4">ЁЯУ▒</div>
        <h1 class="text-xl font-bold mb-2">Mobile Only Link</h1>
        <p class="text-gray-500 text-sm mb-4">ркдркорлЗ ркЖ рк▓рк┐ркВркХ ркорк╛ркдрлНрк░ ркорлЛркмрк╛ркИрк▓ркорк╛ркВ ркЬ ркЦрлЛрк▓рлА рк╢ркХрлЛ ркЫрлЛ. ркорк╣рлЗрк░ркмрк╛ркирлА ркХрк░рлАркирлЗ ркдркорк╛рк░рк╛ ркорлЛркмрк╛ркИрк▓ рклрлЛрки рккрк░ ркЖ рк▓рк┐ркВркХ ркУрккрки ркХрк░рлЛ.</p>
        <div class="p-3 bg-yellow-50 text-yellow-700 text-[10px] rounded-lg border border-yellow-100">
            Please open this link on your mobile device to join the tournament.
        </div>
    </div>

    <!-- рли. ркорлЛркмрк╛ркИрк▓ ркорк╛ркЯрлЗ ркорлЗркИрки ркХрк╛рк░рлНркб -->
    <div id="mobile-content" class="bg-white p-8 rounded-3xl shadow-xl max-w-sm w-full text-center">
        <div class="text-4xl mb-4 text-purple-800">ЁЯПП</div>
        <h1 class="text-xl font-bold mb-2 text-gray-800">Join as Co-Scorer</h1>
        <p class="text-gray-500 text-sm mb-8">Click below to open the CrickMatch app and join this tournament.</p>
        
        <button id="joinBtn" class="w-full bg-[#4A3A8C] hover:bg-[#3b2e70] text-white font-bold py-4 rounded-2xl mb-4 shadow-lg active:scale-95 transition-transform">
            Open App to Join
        </button>
        
        <p class="text-[10px] text-gray-400">If CrickMatch is not installed, you will be redirected to the Store.</p>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const tId = urlParams.get('id');
        const userAgent = navigator.userAgent || navigator.vendor || window.opera;

        // --- PC Detection ---
        const isMobile = /android|iphone|ipad|ipod/i.test(userAgent);
        
        if (!isMobile) {
            document.getElementById('mobile-content').classList.add('hidden');
            document.getElementById('pc-error').classList.remove('hidden');
        }

        document.getElementById('joinBtn').onclick = () => {
            if (!tId) {
                alert("Invalid Link: Tournament ID missing.");
                return;
            }

            const playStoreUrl = "https://play.google.com/store/apps/details?id=com.meetanshi.crickmatch";
            const appStoreUrl = "https://apps.apple.com/us/app/crickmatch-live-scorer/id6755029198";

            // --- Android Logic (Automatic Fallback) ---
            if (/android/i.test(userAgent)) {
                // ркЖ ркЗркирлНркЯрлЗркирлНркЯ рк╕рлАркзрлА ркПркк ркЦрлЛрк▓рк╢рлЗ, ркЬрлЛ ркПркк ркирк╣рлАркВ рк╣рлЛркп ркдрлЛ ркмрлНрк░рк╛ркЙркЭрк░ рккрлЛркдрлЗ рккрлНрк▓рлЗ рк╕рлНркЯрлЛрк░ ркЦрлЛрк▓рлА ркжрлЗрк╢рлЗ.
                // ркЖркирк╛ркерлА рккрлНрк▓рлЗ рк╕рлНркЯрлЛрк░ рккрк╛ркЫрк│ ркЦрлБрк▓рлНрк▓рлБркВ ркирк╣рлАркВ рк░рк╣рлЗ.
                const intentUrl = `intent://join?id=${tId}#Intent;scheme=cricketscorer;package=com.meetanshi.crickmatch;S.browser_fallback_url=${playStoreUrl};end`;
                window.location.href = intentUrl;
            } 
            // --- iOS Logic ---
            else if (/iPad|iPhone|iPod/.test(userAgent)) {
                window.location.href = `cricketscorer://join?id=${tId}`;
                
                // ркЬрлЛ рли.рлл рк╕рлЗркХркирлНркбркорк╛ркВ ркПркк ркирк╛ ркЦрлБрк▓рлЗ ркдрлЛ ркПркк рк╕рлНркЯрлЛрк░ рккрк░ ркЬрк╢рлЗ
                setTimeout(() => {
                    if (!document.hidden) {
                        window.location.href = appStoreUrl;
                    }
                }, 2500);
            }
        };
    </script>
</body>
</html>
